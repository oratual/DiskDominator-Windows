<!DOCTYPE html>
<html>
<head>
<title>DiskDominator</title>
<HTA:APPLICATION 
    ID="DiskDominator"
    APPLICATIONNAME="DiskDominator"
    BORDER="dialog"
    BORDERSTYLE="normal"
    CAPTION="yes"
    ICON="icons/icon.ico"
    MAXIMIZEBUTTON="no"
    MINIMIZEBUTTON="yes"
    SHOWINTASKBAR="yes"
    SINGLEINSTANCE="yes"
    SYSMENU="yes"
    VERSION="0.1.0"
    WINDOWSTATE="normal"
    SCROLL="no"
/>

<style>
body {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
    color: white;
    margin: 0;
    padding: 20px;
    overflow: hidden;
}

.container {
    text-align: center;
    margin-top: 50px;
}

.logo {
    font-size: 72px;
    margin-bottom: 20px;
}

h1 {
    margin: 10px 0;
    font-weight: 300;
    font-size: 36px;
}

.subtitle {
    font-size: 20px;
    opacity: 0.9;
    margin-bottom: 40px;
}

.status {
    background: rgba(255,255,255,0.1);
    border-radius: 8px;
    padding: 20px;
    margin: 20px auto;
    width: 60%;
    min-height: 60px;
    display: flex;
    align-items: center;
    justify-content: center;
}

.status-text {
    font-size: 18px;
}

.spinner {
    border: 3px solid rgba(255,255,255,0.3);
    border-top: 3px solid white;
    border-radius: 50%;
    width: 30px;
    height: 30px;
    animation: spin 1s linear infinite;
    margin-right: 15px;
}

@keyframes spin {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
}

.success {
    color: #4CAF50;
}

.error {
    color: #ff6b6b;
}

button {
    background: #4CAF50;
    color: white;
    border: none;
    padding: 15px 40px;
    font-size: 18px;
    border-radius: 30px;
    cursor: pointer;
    margin: 20px;
    box-shadow: 0 4px 6px rgba(0,0,0,0.1);
    transition: all 0.3s;
}

button:hover {
    background: #45a049;
    transform: translateY(-2px);
    box-shadow: 0 6px 8px rgba(0,0,0,0.15);
}

.browser-info {
    font-size: 14px;
    opacity: 0.8;
    margin-top: 20px;
}
</style>

<script language="VBScript">
Option Explicit

Dim objShell, objFSO, strPath, serverPID
Set objShell = CreateObject("WScript.Shell")
Set objFSO = CreateObject("Scripting.FileSystemObject")

' Get current directory
Dim htaPath
htaPath = window.location.pathname
htaPath = Replace(htaPath, "file:///", "")
htaPath = Replace(htaPath, "/", "\")
strPath = objFSO.GetParentFolderName(htaPath) & "\"

Sub Window_OnLoad
    window.resizeTo 600, 500
    window.moveTo (screen.width - 600) / 2, (screen.height - 500) / 2
    
    ' Auto-start after 1 second
    window.setTimeout "StartServer", 1000
End Sub

Sub StartServer
    UpdateStatus "<div class='spinner'></div><div>Starting DiskDominator server...</div>"
    
    ' Start the dev server in background
    On Error Resume Next
    Set serverPID = objShell.Exec("cmd /c cd /d """ & strPath & """ && npm run dev")
    On Error GoTo 0
    
    ' Wait a bit for server to initialize
    window.setTimeout "CheckServerAndOpen", 3000
End Sub

Sub CheckServerAndOpen
    ' Try to open in browser
    Dim url
    url = "http://localhost:3002"
    
    UpdateStatus "<div class='success'>Opening DiskDominator in your browser...</div>"
    
    ' Try different browsers
    On Error Resume Next
    
    ' Try Brave first
    objShell.Run """C:\Program Files\BraveSoftware\Brave-Browser\Application\brave.exe"" " & url, 0, False
    If Err.Number <> 0 Then
        Err.Clear
        ' Try Firefox
        objShell.Run """C:\Program Files\Mozilla Firefox\firefox.exe"" " & url, 0, False
        If Err.Number <> 0 Then
            Err.Clear
            ' Try default browser
            objShell.Run url, 0, False
        End If
    End If
    
    On Error GoTo 0
    
    window.setTimeout "ShowSuccess", 1000
End Sub

Sub ShowSuccess
    document.getElementById("statusDiv").innerHTML = _
        "<div class='success'>âœ“ DiskDominator is running!</div>" & _
        "<div class='browser-info'>Access it at: http://localhost:3002</div>"
    
    document.getElementById("closeBtn").style.display = "inline-block"
End Sub

Sub UpdateStatus(text)
    document.getElementById("statusDiv").innerHTML = text
End Sub

Sub OpenAgain
    objShell.Run "http://localhost:3002", 0, False
End Sub

Sub CloseApp
    ' Try to stop the server
    On Error Resume Next
    If Not (serverPID Is Nothing) Then
        serverPID.Terminate()
    End If
    
    ' Kill any remaining node processes
    objShell.Run "taskkill /F /IM node.exe", 0, True
    On Error GoTo 0
    
    window.close
End Sub
</script>
</head>

<body>
<div class="container">
    <div class="logo">ðŸ’¾</div>
    <h1>DiskDominator</h1>
    <div class="subtitle">Intelligent Disk Management Suite</div>
    
    <div class="status" id="statusDiv">
        <div>Initializing...</div>
    </div>
    
    <button id="openBtn" onclick="OpenAgain()" style="display: none;">Open in Browser</button>
    <button id="closeBtn" onclick="CloseApp()" style="display: none;">Close Server</button>
</div>
</body>
</html>